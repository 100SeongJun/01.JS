<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>lab05_axios_fetch.html</title>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <!-- <script src="http://kobis.or.kr/kobisopenapi/
    webservice/rest/boxoffice/searchDailyBoxOfficeList.json"></script> -->

</head>

<body>
    <script>
        // axios : 비동기 통신을 위해 사용되는 라이브러리(프로미스 기반)
        // "https://unpkg.com/axios/dist/axios.min.js" 세팅이 필수

        // axios({
        //     method: "GET",
        //     url: "https://jsonplaceholder.typicode.com/users"
        // }).then(response => console.log(response.data))

        //GET : 정보 요청
        // axios.get("https://jsonplaceholder.typicode.com/posts")
        //     .then(response => console.log(response.data))

        // POST : 정보 입력(생성)
        // axios.post("https://jsonplaceholder.typicode.com/posts", {
        //     userId: "js",
        //     id: 101,
        //     title: "js-title",
        //     body: "js-body"
        // }).then((response) => {
        //     console.log(response);
        // });

        // PUT : 정보 수정(전체 정보 수정(덮어쓰기느낌))  //PATCH 입력한 정보만 수정
        // axios.put("https://jsonplaceholder.typicode.com/posts/1", {// id가 1인 값을 수정한다
        //     title: "js-titile-put",
        //     body: "js-body-put",
        // }).then((response) => {
        //     console.log(response);
        // });

        // .then(res=> console.log(res));
        // })
        // axios.patch("https://jsonplaceholder.typicode.com/posts/1", {// id가 1인 값을 수정한다
        //     title: "js-titile-put",
        //     body: "js-body-put",
        // }).then((response) => {
        //     console.log(response);
        // });

        // DELETE : 정보 삭제
        // axios.delete("https://jsonplaceholder.typicode.com/posts/1")
        //     .then((response)=>{
        //         console.log(response);
        //     });

        // fetch : 자바스크립트 내장 라이브러리(프로미스 기반)
        // get
        // fetch("https://jsonplaceholder.typicode.com/posts/1", {
        //     method: "GET"
        // }).then(response => response.json())
        // .then(data => console.log(data));

        // fetch = post
        // fetch("https://jsonplaceholder.typicode.com/posts", {
        //     method: "POST",
        //     headers: {
        //         "Content-Type": "application/json"
        //     },
        //     body: JSON.stringify({
        //         title: "js-titile-fetch",
        //         body: "js-body-fetch",
        //         userId: 11
        //     })
        // }).then(response => response.json())
        // .then(data => console.log(data));

        // fetch("https://jsonplaceholder.typicode.com/posts/1", {
        //     method: "PUT",
        //     headers: {
        //         "Content-Type": "application/json"
        //     },
        //     body: JSON.stringify({
        //         title: "js-titile-fetch",
        //         body: "js-body-fetch",
        //         userId: 11
        //     })
        // }).then(response => response.json())
        // .then(data => console.log(data));

        // fetch("https://jsonplaceholder.typicode.com/posts/1", {
        //     method: "DELETE",
        //     headers: {
        //         "Content-Type": "application/json"
        //     }
        // }).then(response => response.json())
        // .then(data => console.log(data));

        // fetch("https://jsonplaceholder.typicode.com/posts/1",{
        //     method : "delete",
        // }).then(response=> response.json())
        // .then(data => console.log(data));

        // fetch("https://jsonplaceholder.typicode.com/posts/1",{
        //     method:"put",
        //     headers:{
        //         "Content-Type":"application/json"
        //     },
        //     body:JSON.stringify({
        //         title:"Test",
        //         body:"bodyTest",
        //         userId:1,
        //     })

        // }).then(response => response.json())
        // .then(data => console.log(data));

        // axios : 브라우저 호환성이 높음, 요청 객체를 자동으로 JSON으로 변환 기능
        // fetch : 내장 라이브러리, 안정성 높음

        // POSTMAN : REST API 잘 작동하는지 확인하는 툴

        const url = "http://kobis.or.kr/kobisopenapi/webservice/rest/boxoffice/searchDailyBoxOfficeList.json";
        const key = "b1ad87bec27e937ab9dc80a12e762d2d";
        const targetDate = 20211101;
        axios.get(url, {
            params: {
                key: key,
                targetDt: targetDate
            }
        })
        // forEach 방식
        // .then(res => {
        //     res2=res.data.boxOfficeResult.dailyBoxOfficeList
        //     // console.log(res2);
        //     // console.log(res);
        //     res2.forEach(rnum=>{
        //         // console.log(rnum);
        //         if (rnum.audiCnt>=2000 && rnum.showCnt %2 ==1 ){
        //             console.log(rnum);
        //         }
        //     })
        // })  

        // map 방식
        // .then(res => {
        //     res2 = res.data.boxOfficeResult.dailyBoxOfficeList
        //     res2.map((rnum) => {
        //         if (rnum.audiCnt >= 2000 && rnum.showCnt % 2 == 1) {
        //             console.log(rnum);
        //         }}
        //     )})

        // filter 방식
        // .then(data => {
        //     data2 = data.data.boxOfficeResult.dailyBoxOfficeList
        //     console.log(data2);
        //     let dataList = Array.from(data2, res => {
        //         if (res.audiCnt >= 2000 && res.showCnt % 2 == 1) {
        //             console.log(res);
        //         }
        //     }
        //     )
        // })

        // 일별 박스오피스에서
        // 2021년 11월 1일에 관객수가 2000 이상이고
        // 상영된 횟수가 홀수인 영화만 출력해주세요!
        axios.get(baseURL, {
            params: {
                key: keyValue,
                targetDt: targetDate
            }
        }).then(response => response.data)
            .then((data) =>
                data.boxOfficeResult.dailyBoxOfficeList.filter(
                    (el) => (el.audiCnt >= 2000) && (el.showCnt % 2 === 1)
                )
            ).then(result => console.log(result))



    </script>
</body>

</html>